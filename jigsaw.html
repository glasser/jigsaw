<head>
  <title>jigsaw</title>
</head>

<body>
  {{#if loggingIn}}
    Logging in.
  {{else}}
    {{#if currentUser}}
      <h1>Jigsaw</h1>

      {{> userPanel}}

      {{> puzzlePage}}
    {{else}}
      {{> passwordForm }}
    {{/if}}
  {{/if}}
</body>

<template name='userPanel'>
  <div>
      You are:
      {{#if isNobody}}
        nobody. Please log in:
      {{else}}
        <span class='username'>{{currentUser.username}}</span>.
        {{#unless showing 'userDirectory'}}
          <button class='btn btn-mini' id='show-change-username'>change</button>
        {{/unless}}
      {{/if}}
    {{#if showing 'userDirectory'}}
      <div class='form-inline'>
        <select id='directory'>
          {{#each users}}
            <option {{#if current}}selected{{/if}}>{{username}}</option>
          {{/each}}
        </select>
        or other:
        <input type='text' id='username-other' autocomplete='off'>
        <button class='btn btn-primary' id='change-username'>set name</button>
      </div>
    {{/if}}
  </div>
</template>

<template name='passwordForm'>
  <p>What is the password?</p>
  <input type='password' id='globalPassword'>
</template>
