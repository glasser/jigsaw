<head>
  <title>jigsaw</title>
</head>

<body>
  {{> body}}
</body>

<template name='body'>
  {{#if loggingIn}}
    Logging in.
  {{else}}
    {{#if currentUser}}
      {{> navbar}}

      {{!-- dialogs --}}
      {{> addPuzzleDialog}}

      <div class="container">
        <div class="row">
          {{> userPanel}}
          {{> banners}}
        </div>

        {{!-- pages --}}
        {{> puzzlePage}}
        {{> searchPage}}
        {{> adminPage}}
      </div>
    {{else}}
      {{> passwordForm }}
    {{/if}}
  {{/if}}
</template>

<template name='userPanel'>
  <div class="span4">
      You are:
      {{#if isNobody}}
        nobody. Please log in:
      {{else}}
        <span class='username'>{{currentUser.username}}</span>.
        {{#unless showing 'userDirectory'}}
          <button class='btn btn-mini' id='show-change-username'>change</button>
        {{/unless}}
      {{/if}}
    {{#if showing 'userDirectory'}}
      <div class='form-inline'>
        <select id='directory'>
          {{#each users}}
            <option {{#if current}}selected{{/if}}>{{username}}</option>
          {{/each}}
        </select>
        or other:
        <input type='text' id='username-other' autocomplete='off'>
        <button class='btn btn-primary' id='change-username'>set name</button>
      </div>
    {{/if}}
  </div>
</template>

<template name='passwordForm'>
  <p>What is the password?</p>
  <input type='password' id='globalPassword'>
</template>

<template name='navbar'>
  <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <a class="brand" href="/">Jigsaw</a>
        <ul class="nav">
          <li><a href="/foo">Open Puzzles</a></li>
          <li><a href="/admin">Admin</a></li>
        </ul>
      </div>
    </div>
  </div>
</template>

<template name='banners'>
  <div class="alert alert-info span4">
    <ul>
      {{#each allBanners}}
      <li><em>[{{huntTime created}}]</em> {{content}}</li>
      {{/each}}
    </ul>
  </div>
</template>
